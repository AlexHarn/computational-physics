\input{../../header.tex}
\usepackage{verbatim}
\newcommand\OverfullCenter[1]{\noindent\makebox[\linewidth]{#1}}
\begin{document}
\noindent
\centerline{\small{\textsc{Technische Universität Dortmund}}} \\
\large\textbf{Übungsblatt 07} \hfill \footnotesize\textbf{Sebastian Bange, Alexander Harnisch, Alexander Knodel} \\
\normalsize Computational Physics \hfill \today \\
Prof. Dr. Jan Kierfeld \hfill Abgabefrist: 10.06.2016\\
\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\section*{Linear kongruente Generatoren}
Mittels eines linear kongruenten Generators werden Pseudo-Zufallszahlen generiert. Die vorgegebenen Parameter erlauben die Nutzung des \textsc{unsigned int} anstelle des 64-Bit Integers.

\begin{equation}
r_{n+1} = (a\,r_n+c)\,\text{mod}\,m
\label{linConGen}
\end{equation}

\subsection*{Aufgabenteil b: Testen des LKG}
Die Zufallszahlen bei b(iii) und b(iv) wiederholen sich für das $n$ (wenn $n$ der Laufindex bis $N$ sei), das $m$ überschreitet. Der Fall $n=m$ wird ausgelassen, da bei der Wiederholung der Seed $r_0$ in die Daten käme. Faktisch fällt der Seed sogar komplett raus.\\
Es zeigt sich eine gute Gleichverteilung für die ersten Parameter. Lediglich zwischen 0.2 und 0.3, sowie zwischen 0.9 und 1.0 zeigen sich Ausreißer. 

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b1_hist.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(i): Histogramm der Zufallszahlen}
		\label{fig:1b1}
	\end{figure}
\end{landscape}

Im zweiten Histogramm zeigen sich noch etwas größere Abweichungen.

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b2_hist.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(ii): Histogramm der Zufallszahlen}
		\label{fig:1b2}
	\end{figure}
\end{landscape}

In Aufgabenteil b(iii) zeigt sich eine bessere Gleichverteilung.
Durch die deutlich längere Periode ist die Gleichverteilung besser.

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b3_hist.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(iii): Histogramm der Zufallszahlen (RANDU Generator von IBM)}
		\label{fig:1b3}
	\end{figure}
\end{landscape}

Eine ähnliche Gleichverteilung ergibt sich auch im vierten Histogramm.
\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b4_hist.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(iv): Histogramm der Zufallszahlen (ran1() aus den NR, 2. Ausgabe)}
		\label{fig:1b4}
	\end{figure}
\end{landscape}

Insgesamt sind die Generatoren durch wenige Rechenoperationen sehr schnell.

\subsection*{Aufgabenteil c: Korrelationen unter den Zufallszahlen}
Nun sollen die Korrelationen untersucht werden. Während in den ersten beiden Teilaufgaben (i) und (ii) noch eindeutige Symmetrien erkennbar sind, findet man in den letzten beiden Teilaufgaben eher klumpenartige Ansammlungen von Zufallszahlen.

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b1_korr.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(i): Korrelation der Zufallszahlen}
		\label{fig:1b1korr}
	\end{figure}
\end{landscape}

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b2_korr.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(ii): Korrelation der Zufallszahlen}
		\label{fig:1b2korr}
	\end{figure}
\end{landscape}


\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b3_korr.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(iii): Korrelation der Zufallszahlen}
		\label{fig:1b3korr}
	\end{figure}
\end{landscape}


\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/1b4_korr.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 1b(iv): Korrelation der Zufallszahlen}
		\label{fig:1b4korr}
	\end{figure}
\end{landscape}

\section*{Beliebige Verteilungen}
In dieser Aufgabe sollen nun beliebige Verteilungen erzeugt werden.
Die Anzahl der Bins wurde hier auf 100 erhöht und die Histogramme wurden normiert, um sie mit den analytischen Verteilungen zu vergleichen.
\subsection*{Aufgabenteil a: Box-Muller-Algorithmus}
Zur Erzeugung der Gauß-Verteilung wurden die Gleichungen auf S. 176, (10.11) verwendet.

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/2a.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 2a: Histogramm des Box-Muller-Algorithmus}
		\label{fig:2a}
	\end{figure}
\end{landscape}

\subsection*{Aufgabenteil b: Zentraler Grenzwertsatz}

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/2b.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 2b: Histogramm des ZGW}
		\label{fig:2b}
	\end{figure}
\end{landscape}

Eine Verteilung mit der Standardabweichung 1 bekommt man, indem man $N = 12$ setzt. Der Mittelwert ist bei der Addition $N$ gleichverteilter Zufallsvariablen $x_i$ aus [0, 1[ und Subtraktion von $N/2$ etwa Null. Die Methode hat den Nachteil, dass die Extremwerte der Normalverteilung relativ schlecht berücksichtigt werden. Bei $N$ = 12 ist z.B. $-6 \leq y \leq 6$.

\subsection*{Aufgabenteil c: von Neumannsche Rückweisungsverfahren}
Bei diesem Verfahren wurde eine vom Box-Muller-Algorithmus erstellte verschobene Gaußglocke aus Vergleichskurve verwendet, da diese bereits eine starke Ähnlichkeit mit $\frac{\sin(x)}{2}$ aufweist.
Wie in Abbildung \ref{fig:2ctest} zu sehen, liegt die Gaußglocke im gewünschtem Interval auch vollständig oberhalb der gewünschten Verteilung, wenn sie mit 1.5 multipliziert wird.
Bei der generierten Verteilung fällt auf, dass sie merklich nach links verschoben scheint.
Dies scheint unabhängig von dem gewählten Seed zu sein (wir haben aber auch nur 3 getestet).

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/2c_test.pdf}}
		\caption{Test, ob die Gaußglocke über der gewünschten Verteilung liegt.}
		\label{fig:2ctest}
	\end{figure}
\end{landscape}

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/2c.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 2c: Histogramm des Neumannschen Rückweisungsverfahrens}
		\label{fig:2c}
	\end{figure}
\end{landscape}

\subsection*{Aufgabenteil d: Transformationsmethode}
Die generierten Daten passen sehr gut zu gewünschten Verteilung.

\begin{landscape}
	\begin{figure}
		\OverfullCenter{\includegraphics[width=\textwidth]{../A1+A2/2d.pdf}}
		\caption{Graphische Darstellung der Ergebnisse von Aufgabe 2d: Histogramm der Transformationsmethode}
		\label{fig:2ctest}
	\end{figure}
\end{landscape}


%\printbibliography
\end{document}
